TARGET=demo

all: $(TARGET) default.metallib

run: all
	./$(TARGET)

$(TARGET): *.m *.c
	xcrun -sdk macosx gcc *.m *.c -o $@ -framework CoreFoundation -framework Metal -framework Foundation -framework MetalKit

default.metallib: shaders.air
	xcrun -sdk macosx metallib *.air -o default.metallib

%.air: %.metal
	xcrun -sdk macosx metal -c $< -o $@

clean:
	rm -f *.air *.metallib $(TARGET)
