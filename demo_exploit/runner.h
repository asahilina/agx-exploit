#include <stdint.h>
#include <stdbool.h>
#include "types.h"

int runner_init(void);

void readmem(u64 gpuva, size_t size, void *buf);
void writemem(u64 gpuva, size_t size, void *buf);
u64 read64(u64 gpuva);
u32 read32(u64 gpuva);
u16 read16(u64 gpuva);
u8 read8(u64 gpuva);
void write64(u64 gpuva, u64 val);
void write32(u64 gpuva, u32 val);
void write16(u64 gpuva, u16 val);
void write8(u64 gpuva, u8 val);

void vreadmem(u64 ttbr, u64 va, size_t size, void *buf);
void vwritemem(u64 ttbr, u64 va, size_t size, void *buf);
u64 vread64(u64 ttbr, u64 va);
u32 vread32(u64 ttbr, u64 va);
u16 vread16(u64 ttbr, u64 va);
u8 vread8(u64 ttbr, u64 va);
void vwrite64(u64 ttbr, u64 va, u64 val);
void vwrite32(u64 ttbr, u64 va, u32 val);
void vwrite16(u64 ttbr, u64 va, u16 val);
void vwrite8(u64 ttbr, u64 va, u8 val);

bool stage1(void);
bool stage2(u64 *p_ram_start, u64 *ram_size);
bool find_kbase(u64 *base);
bool find_kttbr1(u64 *ttbr1);
